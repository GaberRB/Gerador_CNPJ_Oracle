CREATE  OR REPLACE FUNCTION GERA_CNPJ(V NUMBER) 
   RETURN NUMBER 
IS CNPJ NUMBER(14);
N1 NUMBER;
N2 NUMBER;
N3 NUMBER;
N4 NUMBER;
N5 NUMBER;
N6 NUMBER;
N7 NUMBER;
N8 NUMBER;
N9 NUMBER;
N10 NUMBER;
N11 NUMBER;
N12 NUMBER;
D1 NUMBER;
D2 NUMBER;


BEGIN 
SELECT ROUND(DBMS_RANDOM.VALUE(9,1)) 
INTO N1
FROM DUAL; 

SELECT ROUND(DBMS_RANDOM.VALUE(9,1)) 
INTO N2
FROM DUAL;

SELECT ROUND(DBMS_RANDOM.VALUE(9,1)) 
INTO N3
FROM DUAL; 

SELECT ROUND(DBMS_RANDOM.VALUE(9,1)) 
INTO N4
FROM DUAL; 

SELECT ROUND(DBMS_RANDOM.VALUE(9,1)) 
INTO N5
FROM DUAL; 

SELECT ROUND(DBMS_RANDOM.VALUE(9,1)) 
INTO N6
FROM DUAL; 

SELECT ROUND(DBMS_RANDOM.VALUE(9,1)) 
INTO N7
FROM DUAL; 

SELECT ROUND(DBMS_RANDOM.VALUE(9,1)) 
INTO N8
FROM DUAL;  

N9 := 0;
N10 := 0;
N11 := 0;
N12 := 1;

D1 := N12 * 2 + N11 * 3 + N10 * 4 + N9 * 5 + N8  * 6 + N7 * 7 + N6 * 8 + N5 * 9 + N4 * 2 + N3  * 3 + N2 * 4 + N1 * 5;
D1 := 11 - (MOD(D1, 11));
IF (D1 >= 10) THEN
  D1 := 0;
END IF;

D2 := D1 * 2 + N12 * 3 +  N11 * 4 +  N10 * 5 +  N9 * 6 +  N8 * 7 +  N7 * 8 +  N6 * 9 + N5 * 2 +  N4 * 3 +  N3 * 4 +  N2 * 5 +  N1 * 6; 
D2 :=  11 - (MOD(D2, 11));
IF (D2 >= 10) THEN
  D2 := 0;
END IF; 

CNPJ := N1 || N2 || N3 || N4 || N5 || N6 || N7 || N8 || N9 || N10 || N11 || N12 || D1 || D2; 

RETURN CNPJ;
END GERA_CNPJ;
